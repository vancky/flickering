% !Mode:: "TeX:UTF-8"
% Author: Rickjin (ZhihuiJin@gmail.com)
%
%\chapter{神奇的伽玛函数}

\section{开篇}

数学爱好者们聚集在网络论坛上的一大乐事就是对各类和数学相关的事物评头论足、论资
排辈。如果要评选历史上最伟大的数学家，数学“粉丝”们将围绕高斯、黎曼、牛顿、欧拉、
阿基米德等一流数学人物展开口水战；如果要讨论最奇妙的数学常数，$e$、 $\pi$、
$\phi=\frac{\sqrt{5}-1}{2}$ 肯定成为三大最具实力的竞争对手；如果要推举最美丽的
数学公式，欧拉公式 $e^{i\pi} + 1= 0$  与自然数倒数的级数求和 $ 1 + \frac{1}{2^2} +
\frac{1}{3^2} + \frac{1}{4^2} +  \cdots  = \frac{\pi^2}{6} $ 绝对是榜上有名。那
如果有人追问最神奇的数学函数是什么？ 答案自然又会变得极具争议，而我相信如下这个
长相有点奇特的伽玛函数
$$ \Gamma(x)=\int_0^{\infty}t^{x-1}e^{-t}dt $$
极有资格成为一个热门候选。

伽玛函数是用积分形式定义的{\bf 超越函数}，对于习惯了初等函数的我们，伽玛函数的
长相着实让人觉得有点高深莫测，一副讳莫如深、拒人于千里之外的样子。然而如果我们
只在自然数集合$N$ 上来考察伽玛函数，却发现伽玛函数摇身一变，成为了异常简洁
的模样
\begin{equation}
\label{gamma-factorial}
\Gamma(n) = (n-1)!  \hspace{1cm} \forall n \in N.
\end{equation}
阶乘！那是每个高中生都很熟悉的数学概念，伽玛函数一下变得如此的亲切、平易近人了
。实际上，基于高等数学中的分部积分方法，很容易证明伽玛函数具有如下的递归性质
$$\Gamma(x+1) = x \Gamma(x) .$$ 
由此可以快速推导出 \eqref{gamma-factorial} 式。所以伽玛函
数也被称为{\bf 阶乘函数}。 由于伽玛函数在整个实数轴上都有定义，于是可以看做是阶
乘概念在实数集上的延拓。

如果我们继续多学习一些数学知识，就会惊奇地发现这个具有神秘气质的伽玛函数真是才
华横溢。它栖身于现代数学的各个分支，在微积分、概率论、偏微分方程、组合数学， 甚
至是看起来八竿子打不着的数论当中，都起着重要的作用。 这个函数具有极高的实用价值
，而绝非是数学家凭空臆造的抽象玩具，被频繁应用于现代科学之中，包括物理学、统计
机器学习、人工智能等领域。

笔者主要从事统计自然语言处理和机器学习相关的研究工作，多年来在概率统计和机器学
习中频繁地接触和学习伽玛函数。不过长期以来一直处于一知半解的状态，这个函数令人
心存疑惑：
\begin{enumerate}
\item 伽玛函数这么复杂的表达形式，肯定不可能是凭空想到的，历史上数学家是基于
什么原理找到这个奇特的函数？
\item 现代数学对伽玛函数的定义使它满足 $\Gamma(n) = (n-1)!$，为何定义伽玛函数的时候不让它满足$\Gamma(n) = n!$？
\item 伽玛函数是唯一满足阶乘特性的推广函数吗？ 它有哪些奇特的地方？
\item 伽玛函数在各种概率分布的密度函数中频繁出现，伽玛函数本身是否有直观的概率
解释？
\end{enumerate}

带着这些疑问，笔者翻阅了许多讲解伽玛函数的历史和应用的资料，发现伽玛函数真是一个
来自异族的美女，与生俱来携带着一种神秘的色彩。你要接近她并不难，然而她魅力独特
，令你无法看透。从她出生开始，就吸引着众多一流的数学家对她进行解读。 历史上伽
玛函数的发现，和数学家对阶乘、插值、以及积分的研究有着紧密的联系，而这最早要从
著名的沃利斯公式讲起。

\section{无心插柳 --- 沃利斯公式}

1655年, 英国数学家沃利斯(John Wallis, 1616-1703)写下了一个神奇的数学公式
\begin{equation}
\label{wallis-formula}
\frac{2}{1} \cdot \frac{2}{3} \cdot \frac{4}{3} \cdot \frac{4}{5} \cdot
\frac{6}{5} \cdot \frac{6}{7} \cdot \frac{8}{7} \cdot \frac{8}{9} \cdot \cdots =
\frac{\pi}{2} .
\end{equation}
$\pi$ 居然可以如此齐整地表示成奇数、偶数的比值，真是令人惊讶！$\pi$ 在数学史上
是一个令数学家魂牵梦绕的常数，为了寻求对$\pi$ 这个迷人的常数更加深刻的理解，
数学英雄们前赴后继倾注了无数的精力。数学家陆续发现，$\pi$ 可以表达成许许多多
奇妙的形式，而沃利斯公式是欧洲历史上发现的第二个把 $\pi$ 表达成无穷序列的公式{
\footnote{第一个把$\pi$表示成无穷乘积的式子是法国数学家韦达于1593年给出的：
${\frac {2}{\pi }}={\frac {\sqrt {2}}{2}}\cdot {\frac {\sqrt {2+{\sqrt {2}}}}{2}}\cdot {\frac {\sqrt {2+{\sqrt {2+{\sqrt {2}}}}}}{2}}\cdots $
}。
由于它简洁的对称美，也成为了许多数学人经常提及的数学公式之一。

为何沃利斯公式会和伽玛函数发生联系呢？对沃利斯公式做一下变形整理，就可以得到如
下等价形式
$$ \lim_{n\rightarrow\infty} \frac{(2^n \cdot n!)^4}{[(2n)!]^2(2n+1)} = \frac{\pi}{2} .$$
其中，我们看到了阶乘，所以沃利斯公式天然和阶乘有着紧密的联系，自然也就和阶乘函
数会发生关联。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.3\textwidth]{gamma/john-wallis.jpg}
\caption{沃利斯}
\end{figure}

看着奇妙的沃利斯公式, 我们不禁心生疑问：历史上这个神奇的公式是如何被发现的？
这个公式又如何证明？我们站在现代数学知识的高度来回望历史，其实利用微积分的知识
来推导这个公式并不难，许多微积分课本上都会提供一个证明，证明的主要思路是从积分
式 $$ I(n) = \int_0^\pi \sin^nxdx $$ 出发，通过分部积分可以得到一个关于$I(n)$
的递推公式，反复使用这个递推公式就可以证明结论。 

上述这个证明思路有点繁琐，著名数学家波利亚(George P\'{o}lya, 1887-1985) 在它的
名著《数学与猜想》中提到了另外一个符合直觉、令人赏心悦目、但不算严格的“证明”
思路, 我们来欣赏一下。基于高中数学知识我们知道：
\begin{itemize}
\item 如果一个多项式$f(x)$ 有零点 $x_1, x_2, \cdots,
x_n$(此处$x_i, x_j$ 可以相同, 对应于有重根的情形), 那么 $f(x)$ 一定可以表示为 
$$ f(x) = a_0 (x-x_1) (x-x_2) \cdots (x-x_n) .$$ 
\item 正弦函数 $\sin x$ 有无穷多个零点 $0, \pm\pi, \pm 2\pi, \pm 3\pi, \cdots $。 
\end{itemize}
以上两个知识点看起来毫不相干，因为我们都知道正弦函数 $\sin x$ 并不是一个多项式
。然而大数学家欧拉(Leonhard Euler, 1707-1783)却为这两个看似不相关的知识搭建桥梁
，大胆地猜测 $\sin x$ 也具有多项式的这种性质。也就是
\begin{equation}
\label{euler-sinx}
\sin x = x \prod_{n=1}^\infty\left(1 - \frac{x^2}{n^2\pi^2}\right) 
= x (1- \frac{x^2}{\pi^2})  (1- \frac{x^2}{4\pi^2})  (1- \frac{x^2}{9\pi^2}) \cdots .
\end{equation}
这样看似瞎猜的式子也能成立？是的，利用现代数学分析的知识可以严格证明，欧拉的猜
测完全正确!  

正弦函数 $\sin x$ 是我们极为熟悉的，它可以通过多项式级数展开来表示，这一点对
于理工科背景的大学生也是常识。在微积分课程中我们都会学习 $\sin x$ 的泰勒级数
展开式
$$ \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots  .$$
但是把 $\sin x$ 表示成无穷乘积的展开式\eqref{euler-sinx} 恐怕就不为大众所熟悉了
，通常是数学背景的学生才会接触到。\eqref{euler-sinx} 这个展开式在数学推导中有许
多妙用。数学史上它发挥的第一个重要作用，就是帮助欧拉推导出了如下美丽的公式
\footnote{自然数平方倒数级数求和问题在历史上极为有名，被称为贝塞尔问题，该问题
首先由皮耶特罗·门戈利在1644年提出，几十年来难倒众多数学家，欧拉于1735年给出精
确答案而名声大噪，当时欧拉年仅 28 岁。}
$$ 1 + \frac{1}{2^2} + \frac{1}{3^2} + \frac{1}{4^2} +  \cdots  = \frac{\pi^2}{6} . $$ 
\eqref{euler-sinx} 式的另一个妙处就是可以用于证明沃利斯公式， 不过这个思路并非
欧拉本人给出，而是后来的数学家发现的。 在\eqref{euler-sinx} 式中取
$x=\frac{\pi}{2}$, 可以得到
$$ 1 = \frac{\pi}{2} \prod_{n=1}^\infty\left(1 - \frac{1}{4n^2}\right)
= \frac{\pi}{2} \prod_{n=1}^\infty\left(\frac{2n-1}{2n} \cdot \frac{2n+1}{2n}\right), 
$$
所以
$$ \frac{\pi}{2} = \prod_{n=1}^\infty\left(\frac{2n}{2n-1} \cdot \frac{2n}{2n+1}\right) .
$$
上式正好就是沃利斯公式。之所以说以上的证明不够严格，是由于欧拉给的$\sin x$
无穷乘积展开式的严格证明并不简单，依赖于现代数学分析理论。 

欣赏完沃利斯公式的证明，我们把镜头重新拉回到沃利斯生活的年代。要知道沃利斯给出
他的公式是在 1655 年，那时候牛顿刚满13岁，莱布尼茨更小，欧拉还没出生，整个欧洲
数学界对微积分的认识还停留在非常粗糙的萌芽阶段，对正弦函数 $\sin x$ 的认识也非
常有限， 所以沃利斯当然不可能用上述思路找到他的公式， 那沃利斯是如何发现这个
$\pi$ 的无穷乘积表达式的呢？

在沃利斯的时代，微积分有了初步的进展，当时考虑的典型的问题是求一个曲线和坐标
轴围成的面积。欧洲的数学家追寻阿基米德一千多年前开创的穷竭法，把曲线下的面积
表达为求无穷多个矩形面积的和。当积分的思想在十七世纪开始逐步发酵的时候，沃利斯
已经能够运用积分的思路处理一些简单曲线的面积。譬如，对于最简单的幂函数曲线
$y=x^n$，使用我们现在的数学记号， 沃利斯时代的数学家获得了如下的结果
$$ \int_0^1 x^n dx = \frac{1}{n+1},  n=0,1,2,\cdots .$$

\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{gamma/circle-area.png}
\caption{求圆弧下的面积}
\end{figure}

圆的面积一直是千百年来数学家们深入关心和研究的问题，很自然地沃利斯也想到了可以
使用同样的思路来处理圆的面积。 不过数学家早已经证明圆的面积是 $\pi r^2$，用
积分的方法去计算圆的面积能带来什么好处呢？ 沃利斯在此做了一个漂亮的逆向思维：我们已
经知道四分之一的单位圆圆弧 $y=\sqrt{1-x^2} (0 \le x \le 1)$ 和坐标轴围成的面积
是 $\frac{\pi}{4}$, 如果这个面积能通过无穷分割的方法表达为一个解析表达式，那
这个解析表达式就可以用于计算 $\pi$ 。

然而沃利斯在处理这个圆弧下的面积的时候遇到了困难。虽然基于无穷分割的方法可以得到 
$$ \int_0^1 (1-x^2)^{1/2} dx = \lim_{n\rightarrow \infty} \frac{1}{n} \sum^n_{k=1} \sqrt{1-\frac{k^2}{n^2}} ,$$ 
但是这个极限难以简化计算。 数学家做数学研究的时候有一些思路非常奇特，当遇
到一个特定的问题无法求解之时，他们会考虑逆流而上，把原本的问题泛化为一个更一般
的问题来思考, 原始的问题就成为这个升级版本的特例。表面上看问题变得更加困难复杂
了，然而在思考一个更一般的问题的时候却往往容易发现规律。 沃利斯就是利用这样的技巧
来处理他遇到的难题：

\begin{enumerate}
\item 考虑更一般的曲线面积问题
$$ A_{p,q} = \int_0^1 (1-x^\frac{1}{p})^q dx ,$$ 
原来的问题变成了一个特例：计算 $A_{\frac{1}{2},\frac{1}{2}}$ ；

\item 对$p,q$ 为整数的情况做计算，并系统地列成表格， 从表格中观察变化规律，总结出一般的公式；
\item 把计算公式从$p,q$为整数的情形延拓、内插到分数的情形，从而计算出
$A_{\frac{1}{2},\frac{1}{2}}$ 。
\end{enumerate}

沃利斯对 $p,q = 1,2,\ldots,10$ 做了计算， 发现$A_{p,q}$ 这个表格不太好处理，改
为倒数之后容易分析。取 $B_{p,q} = \frac{1}{A_{p,q}}$, 列出表格(见表 \ref{B-table})
仔细一分析， 就会发现，面对着左上角$B_{0,0}$ 的一系列平行对角线上的数居然恰好构
成了帕斯卡三角形！ 这个三角形中的组合数已经是数学家熟悉知的， 于是沃利斯很容易
地得到
\begin{equation}
\label{wallis-Bpq}
B_{p,q} = \frac{(p+q)!} {p! q!} = \frac{1}{p!} (q+1) (q+2) \cdots (q+p) \quad q=0,1,2 \cdots .
\end{equation}
由上式进一步可以得到如下递推公式
\begin{equation}
\label{wallis-Bpq-recursion}
B_{p,q} = \frac{p+q}{q} B_{p,q-1} .
\end{equation}
原始的问题就转化为计算 $B_{\frac{1}{2},\frac{1}{2}}$。 沃利斯由此开始他极具洞察力的推广：
\begin{enumerate}
\item 把$B_{p,q}$ 从整数推广到分数。虽然 \eqref{wallis-Bpq} 和 \eqref{wallis-Bpq-recursion}是基于$p,q$ 为整数得到
的， 但是也应该适用于分数的情形；
\item 由于原始表格是对称的， 推广到分数之后的表格依然应该保持对称性。
\end{enumerate}


\begin{table}[htb]
\centering
\caption{\label{B-table} $B_{pq}$ 数值表}
\includegraphics[width=0.8\textwidth]{gamma/B-table.png}
% \begin{tabular*}{0.8\textwidth}{@{\extracolsep{\fill}}|c|ccccccc|}
% \hline
% \diagbox{p}{q} & 0 & 1 & 2 & 3 & 4 & \ldots & 10 \\
% \hline
% 0 & 1 & 1 & 1 & 1 & 1 & \ldots & 1  \\
% 1 & 1 & 2 & 3 & 4 & 5 & \ldots & 11  \\
% 2 & 1 & 3 & 6 & 10 & 15 & \ldots & 66  \\
% 3 & 1 & 4 & 10 & 20 & 35 & \ldots & 286  \\
% 4 & 1 & 5 & 15 & 35 & 70 & \ldots & 1001  \\
% \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots  \\
% 10 & 1 & 11 & 66 & 286 & 1001 & \ldots & 184756  \\
% \hline
% \end{tabular*}
\end{table}

基于对称性假设和计算式\eqref{wallis-Bpq}, 我们可以得到，
$$ B_{\frac{1}{2}, 1} =  B_{1, \frac{1}{2}} = \frac{1}{1!}(\frac{1}{2} + 1)  =  \frac{3}{2} .$$
考虑 $p=\frac{1}{2}$ 的情形, 重复使用迭代公式 \eqref{wallis-Bpq}, 容易得到
$$ B_{\frac{1}{2}, m} = \frac{2m+1}{2m}\cdot \frac{2m-1}{2m-2} \ldots \frac{5}{4} \cdot\frac{3}{2} ,$$
$$ B_{\frac{1}{2}, m+\frac{1}{2}} = \frac{2m+2}{2m+1} \cdot\frac{2m}{2m-1} \ldots \frac{4}{3} 
\cdot B_{\frac{1}{2}, \frac{1}{2}} . $$
由于 $B_{\frac{1}{2}, q}$  是基于$q$ 递增的，所以有
$$ B_{\frac{1}{2}, m-\frac{1}{2}} < B_{\frac{1}{2}, m}  < B_{\frac{1}{2}, m+\frac{1}{2}}  .$$
利用\eqref{wallis-Bpq-recursion} 式这个递推公式，马上可以得出上式两端有相同的极限
$$ \lim_{m \rightarrow \infty} B_{\frac{1}{2}, m+\frac{1}{2}} 
= \lim_{m \rightarrow \infty} \frac{2m+2}{2m+1}  B_{\frac{1}{2}, m-\frac{1}{2}} 
= \lim_{m \rightarrow \infty} B_{\frac{1}{2}, m-\frac{1}{2}} .
$$  
利用两侧极限的夹逼，可以得到
$$ \lim_{m \rightarrow \infty} B_{\frac{1}{2}, m} = \lim_{m \rightarrow \infty} B_{\frac{1}{2}, m+\frac{1}{2}}  .$$
即有
$$ 
\frac{3}{2} \cdot \frac{5}{4} \cdot \cdots \cdot \frac{2m-1}{2m-2} \cdot \frac{2m+1}{2m} \cdots 
= B_{\frac{1}{2}, \frac{1}{2}} \cdot \frac{4}{3} \cdot \cdots \cdot \frac{2m}{2m-1} \cdot  \frac{2m+2}{2m+1} \cdot \cdots ,
$$
所以
$$ 
\frac{2}{B_{\frac{1}{2}, \frac{1}{2}}} = \frac{2}{1} \cdot\frac{2}{3} \cdot\frac{4}{3}\cdot \frac{4}{5}\cdot
\cdots \cdot \frac{2m-2}{2m-1}\cdot \frac{2m}{2m-1} \cdot \frac{2m}{2m+1} \cdot \frac{2m+2}{2m+1} \cdot\cdots .
$$
由于 $A_{\frac{1}{2}, \frac{1}{2}} $是四分之一圆的面积，所以$\displaystyle
\frac{2}{B_{\frac{1}{2}, \frac{1}{2}}} = 2A_{\frac{1}{2}, \frac{1}{2}} =
\frac{\pi}{2} $, 代入上式就得到了沃利斯公式 \eqref{wallis-formula}。

上述推导的基本思想是在沃利斯的名著《无穷分析》（Arithmetica Infinitorum，1655）
中给出的。沃利斯公式对$\pi$ 的表示如此奇特，以至于著名物理学家惠更斯第一次见到
这个公式的时候根本不相信，直到有人给惠更斯展示了利用该公式对$\pi$做近似计算的结
果，才消除了惠更斯的疑惑。沃利斯是在牛顿之前英国最有影响力的数学家，他的这本书
包含了现代微积分的先驱工作，对后来的数学家产生了重要的影响，包括牛顿、斯特林、
欧拉。沃利斯把组合数$B_{p,q}$ 从整数推广到分数的方法很有创造性，牛顿1642年研读沃
利斯的这本书的时候受到启发，把二项式定理从整数的情形推广到了分数的情形，这也是
牛顿有生以来的第一个数学发现。而牛顿后续在微积分上的工作也同样受到了沃利斯的深
刻影响。 

回过头来我们观察一下沃利斯公式推导过程中使用的\eqref{wallis-Bpq} 式，组合数
$B_{p,q}$ 中包含了阶乘$p!$、 $q!$, 当沃利斯认为这个公式也适合于$p, q$ 为
分数的情形的时候，隐含了一个假设：{\bf 阶乘这个源自整数的概念也可以推广到分数情
形}。虽然沃利斯并没有清晰地提出把阶乘概念推广到分数， 沃利斯对一些特殊积分式的
研究方法、沃利斯公式的结论、以及推导过程却给后来的数学家进一步研究阶乘提供了许
多重要的线索，也为未来伽玛函数的发现埋下了一颗种子。 

\section{近似与插值的艺术}

十七世纪中期，由于帕斯卡、费马、贝努利等数学家的推动，概率论以及与之相关的组合
数学获得了很大的发展，阶乘开始频繁的出现在数学家的研究工作中。 由于$n!$随$n$
的增长速度太快，在缺乏高效计算工具的年代，数学家们首先面对的挑战就是阶乘的数值
计算。 真正地开始对 $n!$ 进行细致地研究并取得突破的，是数学家棣莫弗(Abraham
de Moivre, 1667-1754)和斯特林(James Stirling, 1692-1770)。

\begin{figure}[htbp]
\centering
\vspace{1cm}
\includegraphics[width=0.3\textwidth]{gamma/abraham-de-moivre.jpg}
\caption{棣莫弗}
\end{figure}

棣莫弗从1721年开始考虑二项分布的概率计算问题，其中一个问题是：当$n \rightarrow
\infty $时，如何计算对称二项分布的中间项的概率
$$ b\left(n, {1\over2}, {n \over 2}\right) = \binom{n}{{n \over 2}} 
\left(\frac{1}{2}\right)^n 
= \frac{n!}{({n\over 2})! \cdot ({n \over 2})!} \left(\frac{1}{2}\right)^n .$$
上式中假设了$n$为偶数。棣莫弗经过一番复杂的推导计算，得到了如下的结果
$$ b\left(n, {1\over2}, {n\over2}\right) \approx  2.168 \frac{(1 - {1\over n})^n} {\sqrt{n-1}} 
\approx \frac{2.168 e^{-1}}{\sqrt{n}}.$$
1725年，斯特林得知了棣莫弗的研究问题和结果，激起了他浓厚的兴趣。斯特林经过
细致的推导，得到了如下更加漂亮的结果
$$ b\left(n, {1\over2}, {n\over2}\right) \approx \sqrt{\frac{2}{\pi n}} ,$$
并写信告知了棣莫弗。斯特林的结果中最引人注目的地方就是 $\pi$ 的
引入，这给棣莫弗很大的启发。 基于上述二项概率计算的研究，棣莫弗最终给出了如下重
要公式
$$ n! \approx C \sqrt{n} \left(\frac{n}{e}\right)^{n} ,$$
其中$C$ 是一个常数。而在斯特林推导$b(n, {1\over2}, {n\over2})$ 过程中引入 $\pi$ 的
启发下， 1730 年棣莫弗利用沃利斯公式推导出了 $C = \sqrt{2\pi}$，也就是得到了斯
特林公式
$$ n! \approx \sqrt{2\pi n} \left(\frac{n}{e}\right)^{n} .$$
所以现代数学史研究大都认为斯特林公式的最主要贡献者是棣莫弗，斯特林的贡献主要
在常数$C$ 的确定。 不过科学发展史中长期以来都存在一个被称之为 Stigler's Law 的
著名现象：绝大多数科学成果的冠名，大都不是历史上首位发现者的名字。这主要是由于
早年通讯不发达、信息传播成本太高导致的。如今互联网如此发达，学术界任何重要
的科研进展都可以快速传导到世界各地，这种问题的发生概率大大降低了。 

斯特林公式自发现以来，就吸引了众多数学家对它进行研究，提出了多种多样的证明方法
。实际上，从沃利斯公式出发就可以证明斯特林公式，甚至可以进一步证明斯特林公式和
沃利斯公式完全等价。在多种证明方法中，有一个基于概率论的非常简洁的证明思路
：利用泊松分布的特性，再加上中心极限定理，我们可以快速地推导出斯特林公式。

假设 $X_1, X_2,\ldots, X_n $ 都是服从参数 $\lambda=1$ 的泊松分布的
独立随机变量，取 $S_n=\sum_{i=1}^n X_i$, 则由泊松分布的可叠加性， 容易知道 $S_n
\sim Poisson(n)$。 由泊松分布的性质可知$S_n$ 的均值和方差都是 $n$, 利用中心
极限定理可以得到
$$ Z_n = \frac{S_n - E(S_n)}{\sqrt{ Var(S_n) }} = \frac{S_n - n}{{\sqrt n }} 
\rightarrow Z, \quad Z \sim N(0,1) .$$
其中，$Z$ 为正态分布随机变量，相应的密度函数为
$$ \displaystyle f(z)=\frac{1}{\sqrt{2\pi}}e^{-\frac{z^2}{2}} .$$
所以，我们有如下推导
\begin{eqnarray*}
\begin{array}{lll}
P\{{S_n} = n\} & = & \displaystyle P\{ n - 1 < {S_n} \le n\}  \\ 
              & = & \displaystyle P\{ -\frac{1}{{\sqrt n }} < \frac{{{S_n} - n}}{{\sqrt n }} \le 0\}  \\ 
              & \approx  & \displaystyle P\{ -\frac{1}{{\sqrt n }} < Z \le 0\}  \\ 
 & = & \displaystyle \int_{ - \frac{1}{{\sqrt n }}}^0 f(z) dz  \\ 
 & \approx & f(0) [0 - ( - \frac{1}{{\sqrt n }})] \\
 & = & \displaystyle \frac{1}{\sqrt{2\pi n}} .\\
\end{array}
\end{eqnarray*}
由于$S_n$ 符合参数$\lambda =n$ 的泊松分布，实际上有
$$ P\{ {S_n} = n\}  = \frac{{{e^{ - n}}{n^n}}}{{n!}} .$$
综合以上推导可以得到
$$ \frac{{{e^{ - n}}{n^n}}}{{n!}} \approx \frac{1}{\sqrt{2\pi n}}. $$
上式稍微整理一下就得到斯特林公式。这个推导的思路看起来非常初等，但是由于中心极
限定理的严格证明非常困难，所以不能被认为是一个严格的初等证明。不过该推导让我们
从概率角度来理解斯特林公式，同时也解释了斯特林公式中的$\pi$ ，是由于正态分布的
引入导致的。

斯特林公式非常有用，通过它可以得出$n!$ 非常精确的估计值。甚至当 $n$ 很小的时候
，斯特林公式的逼近都相当精确。虽然$n$ 足够大时绝对误差可以超过任何数，但是相对
误差很小，并且下降得非常快。\begin{table}[htb]
\centering
\caption{斯特林公式计算精度}
\begin{tabular*}{0.9\textwidth}{@{\extracolsep{\fill}}|c|ccccc|}
\hline
$n$ & 1 & 2 & 5 & 10 & 100 \\
\hline
$n!$ & 1 & 2 & 120 & 3628800 &  $\cdots$ \\
\hline
斯特林公式 & 0.9221 & 1.919 & 118.019 & 3598600 & $\cdots$ \\
\hline
相对误差 & 8\% & 4\% & 2\% & 0.8\%  & 0.08\% \\
\hline
\end{tabular*}
\end{table}

然而，斯特林对于阶乘的探究并未止步于近似计算。斯特林长期追
寻沃利斯和牛顿在插值计算方面的工作，研究各种数列的插值问题。例如，自然数的加法
序列 $1, 1+2, 1+2+3, 1+2+3+4, 1+2+3+4+5 \cdots$, 其通项公式可以写为 $f(n) =
n(n+1)/2$ ，该公式在$n$ 为实数的时候也是适用的，譬如我们可以计算
$f(\frac{1}{2})$。直观地说就是我们找到了一条通过所有整数点 $(n,n(n+1)/2)$，并且
具有简洁的解析表达式的平滑曲线$y=x(x+1)/2$ ，从而可以把定义在整数集上的通项公式
延拓到实数集合。

自然数的加法序列可以很容易地延拓到实数集合上做计算，
很自然地我们就会问下一个问题：自然数的乘法序列 $1,1\cdot2, 1\cdot2\cdot3,
1\cdot2\cdot3\cdot4, 1\cdot2\cdot3\cdot4\cdot5,  \cdots$ 能否做类似的推广？
我们可以计算 $2!,3!$, {\bf 如何计算 $(\frac{1}{2})!$？} 读者不妨自己尝试一下，
很快就会发现，乘法可不像加法那么容易处理，要给出分数的阶乘定义着实有点困难。 如
果把$(n,n!)$ 最初的一些点描在坐标轴上(见图\ref{factorial-curve})，可以看到，画
出一条通过这些点的平滑曲线很容易，但是如何找到一个简洁的解析表达式呢？

斯特林开始研究阶乘序列 $1!, 2!,3!,4!,5!  \cdots$ 延拓到实数上的计算问题
。 对于一个整数序列，如果无法给出一个显示解析表达式把通项公式延拓到实数集合上，
一种退而求其次的方法就是利用多项式插值做近似计算。 我们知道平面上 $n+1$ 个点可
以确定一条 $n$ 次多项式曲线。为了计算实数点对应的值，可以利用该实数点周围的
$n+1$个整数点去拟合一条 $n$ 次多项式曲线，从而近似地估算实数点的值。斯特林在
1730 年出版的一本书中描述了基于多阶差分处理序列插值的方法，这些方法本质上类似于
利用多项式曲线做插值。

\begin{table}[htb]
\centering
\begin{tabular*}{0.9\textwidth}{@{\extracolsep{\fill}}|cccccccccc|}
\hline
&&&&& n!的值 &&&& \\
$n$ & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & $\cdots$ \\
$n!$ & 1 & 2 & 6 & 24 & 120 & 720 & 5040 & 40320 & $\cdots$ \\
\hline
\end{tabular*}
\end{table}

\begin{figure}[htbp]
\centering
\includegraphics[width=0.6\textwidth]{gamma/factorial-curve.png}
\caption{\label{factorial-curve}通过$(n,n!)$的曲线}
\end{figure}


但是$n!$这个数列的增长速度过快，如果没有计算工具的协助，要做这个序列的插值计算也
绝非易事。幸运的是对数已经被纳皮尔(John Napier, 1550-1617) 发明出来，在数值计算
上显示了神通，被科学家们广泛接纳。斯特林和棣莫弗在他们的研究中大量地使用对数做
计算，所以很自然地斯特林转而考虑对对数序列 $\log_{10} n!$ 做插值计算。 

通过插值方法并结合对数运算的技巧，斯特林计算出 $\log_{10} (10\frac{1}{2})!=
7.0755259056$, 由此得到 $(10\frac{1}{2})! = 11899423.08$。斯特林接下来的处
理非常有意思，由于原始的阶乘数列满足递归式 $T(z) = z \cdot T(z-1)$，斯特林基于
插值的原则进行推理，认为被插值的中间项 $(\frac{1}{2})!, (1\frac{1}{2})!,
(2\frac{1}{2})!  \cdots, (9\frac{1}{2})!, (10\frac{1}{2})!$ 也应该满足这个递归
式, 于是有 
$$ \left(10\frac{1}{2}\right)! = 10\frac{1}{2} \cdot
9\frac{1}{2} \cdot  \cdots \cdot  1\frac{1}{2} \cdot \left(\frac{1}{2}\right)! $$ 
上式中代入$(10\frac{1}{2})!$的值，然后计算得到 
$$\left(\frac{1}{2}\right)! = 0.8862269251 .$$
这个结果初看起来平淡无奇，然而斯特林天才地指出，上式实际上应该是
\begin{equation}
\label{half-factorial}
\left(\frac{1}{2}\right)! = \frac{\sqrt\pi}{2} .
\end{equation}
居然出现了$\pi$, 这真是一个令人惊诧的结果！

我们不太确定斯特林是如何推断出 \eqref{half-factorial} 式的，因为在斯特林的论述
中他只是把 $(\frac{1}{2})!$ 的计算结果和 $\frac{\sqrt\pi}{2}$ 做了数值比较，并
没有进行严谨的数学推导，所以看起来好像是数值对比后猜测的结果。即便如此，这也展
示了斯特林强大的数学直觉。

考虑到我们熟悉的斯特林公式是斯特林和棣莫弗共同创造的，斯特林要利用他的插值
过程更加严谨地推导这个结果其实也很容易，虽然没有证据表明斯特林做过这种推导。
基于斯特林对 $\log_{10} n!$ 的插值处理方法，如果我们只是使用一次多项式（即直线
）做插值处理，那么中间项的插值就是两端的算术平均
$$ \log_{10} \left(n+\frac{1}{2}\right)! = \frac{\log_{10} n! + \log_{10} (n+1)!}{2} .$$
所以
$$ \left(n+\frac{1}{2}\right)! = \sqrt{n! (n+1)!} = n! \sqrt{n+1} ,$$
把递归式 $T(z) = z \cdot T(z-1)$ 应用于 $(n+\frac{1}{2})!$ 可以得到
$$ \left(n+\frac{1}{2}\right)! 
= (n+\frac{1}{2}) \cdot (n-\frac{1}{2}) \cdots \frac{3}{2} \cdot \left(\frac{1}{2}\right)! .$$
利用斯特林公式推导可以得到
\begin{align*}
\left(\frac{1}{2}\right)! & = \frac {n! \sqrt{n+1}} {(n+\frac{1}{2}) 
\cdot (n-\frac{1}{2}) \cdots \frac{3}{2}} \\
& = \frac {\sqrt{n+1} \cdot 2^{2n} \cdot n! \cdot n!} {(2n+1)!}  \\
& \displaystyle \approx \displaystyle \frac {\sqrt{n+1} \cdot 2^{2n}  
\cdot \sqrt{2\pi n} (\frac{n}{e})^n \cdot \sqrt{2\pi n} (\frac{n}{e})^n} 
{\sqrt{2\pi(2n+1)} (\frac{2n+1}{e})^{2n+1}} \\
& = \displaystyle \frac{\sqrt\pi}{2} \cdot \frac{e}{(1+\frac{1}{2n})^{2n}}  
\cdot \frac{\sqrt{2n+2}\cdot 2n}{\sqrt{2n+1}\cdot (2n+1)} \\
& \rightarrow \frac{\sqrt\pi}{2} \hspace{0.5cm} (n \rightarrow \infty) .
\end{align*}

\begin{figure}[htbp]
\centering
\includegraphics[width=0.4\textwidth]{gamma/stirling_grave.jpg}
\caption{斯特林的墓碑}
\end{figure}

斯特林的插值研究成果发表于1730年出版的《Methodus Differentialis》中，原书由拉丁
文写成，数学工作者把它翻译成了英文，并对斯特林的研究成果提供评论，使得我们有机会
追寻斯特林研究的原始足迹。 基于强大的斯特林公式，斯特林可以对$n!$ 进行便捷的近
似计算，进一步基于多项式插值的思路，斯特林也已经可以近似计算$n$为分数时的阶乘。
然而斯特林的思路遗憾地停留在数值近似计算上，没有把 $n!$ 到分数的延拓更细致地追
究下去。

% http://math.stackexchange.com/questions/109305/how-much-of-stirling-is-in-stirlings-formula
% knuth Why Pi

\section{三封信---伽玛函数的诞生}

在十七、十八世纪通讯不发达的年代，信在科学家的沟通交流中承载了极其重要的作用。
大量著名的科学研究成果是在科学家的私人笔记、朋友通信之中被首次记录的, 甚至许多
重要的研究成果都尘封在笔记、信件之中未被正式发表。因此大师的笔记、信件都成了
科学史研究的重要资料。 伽玛函数这个重要的数学函数， 在数学史上的首次现身就是在
数学家的信件中。

当斯特林着迷于他的阶乘插值研究的时候， 无独有偶，同一时代的另一位数学家哥德巴赫，几
乎在同一时间也在思考阶乘推广到分数的问题。哥德巴赫的名字在中国可以说是家喻户晓。由于
中国数学家在数论领域的杰出成就，和素数相关的哥德巴赫猜想作为数学皇冠上的明珠就
一直吸引着无数中国人的目光。 哥德巴赫一生对数列的插值问题都保持浓厚的兴趣，他很
早就开始考虑阶乘的插值问题。不同于斯特林的思路，哥德巴赫并不满足于近似数值计算
，而是希望能找到一个简洁的通项公式，既可以准确地描述整数的阶乘$n!$, 又能够推广到分数情形
。做了一些努力尝试之后哥德巴赫发现自己无法解决这个问题。幸运的是他交友广泛，和
当时许多著名的数学家都有联系，包括莱布尼茨以及数学史中出了最多位数学家的贝努利
家族。分数阶乘的问题困恼哥德巴赫多年，他不停地思考，也时常请教他的朋友。
1722 年他找尼古拉斯·贝努利讨论，不过没有取得实质性进展； 1729年他又把问题呈现
给了尼古拉斯的弟弟丹尼尔·贝努利，丹尼尔于当年10月给哥德巴赫的一封信中
给出了漂亮的解答。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.3\textwidth]{gamma/goldbach2.jpg}
\quad\quad
\includegraphics[width=0.3\textwidth]{gamma/Daniel_Bernoulli_by_Grooth.jpg}
\caption{哥德巴赫和丹尼尔·贝努利}
\end{figure}


丹尼尔解决分数阶乘的思路非常漂亮：{\bf 突破有限，取道无穷！} 不拘泥于有限，而是
直接跳跃到无穷乘积的形式来考虑阶乘的插值。丹尼尔发现，如果 $m,n$都是正整数，当 $m
\rightarrow \infty$时，有
$$ \frac{1\cdot 2\cdot 3 \cdots m}{(1+n)(2+n)\cdots (m-1+n)}(m+\frac{n}{2})^{n-1} 
\rightarrow n! .$$
利用这个无穷乘积的方式可以把$n!$的定义自然地延拓到实数集。例如，取 $n=2.5$, $m$
足够大，基于上式就可以近似计算出 $2.5!$；而当$m$趋向无穷的时候，上式的极限就是
$2.5!$的精确值。丹尼尔是如何灵光乍现想到用无穷乘积的思路去解决问题的，我们无从
知晓。他能够从有限插值的围墙中跳出，足以显示他优秀的数学才能。无穷在整个数学发
展史中发挥着巨大的作用，笔者不敢妄加评论二十世纪之后的数学，然而如果说“无穷是
数学发展的发动机”，在二十世纪之前，这句评论应该不会过分。历次数学危机是因为无
穷而产生，几次数学的重大进展和飞跃也是由于数学家更加深刻地认识了无穷。 

丹尼尔的这封信成功地解决了整数阶乘到分数的推广问题，它犹如濛濛细雨，唤醒了伽玛
函数的种子，只是种子还很虚弱，在土中默默地等待着一位数学大师的灌溉。

年轻的欧拉当时正和丹尼尔·贝努利一块在圣彼得堡，他也因此得知了分数阶乘的问题。
欧拉和贝努利家族有着深厚的渊源，他是约翰·贝努利 (Johann Bernoulli, 1667-1748)
的学生， 这位约翰也就是尼古拉斯和丹尼尔的父亲。我们应该感谢约翰·贝努利，正是他
发现并培养了欧拉的数学才能。 在尼古拉斯和丹尼尔的推荐之下，年轻的欧拉于1727年在圣
彼得堡科学院获得了一个职位。受到丹尼尔·贝努利的思路的启发，欧拉也采用无穷乘积
的方式给出了另外一个$n!$ 的公式
\begin{equation}
\label{euler-series}
\Bigl[\Bigl(\frac{2}{1}\Bigr)^n\frac{1}{n+1}\Bigr]
\Bigl[\Bigl(\frac{3}{2}\Bigr)^n\frac{2}{n+2}\Bigr]
\Bigl[\Bigl(\frac{4}{3}\Bigr)^n\frac{3}{n+3}\Bigr] \cdots = n! .
\end{equation}
用极限形式，这个式子可以写为
\begin{equation}
\label{euler-series2}
\lim_{m \rightarrow \infty} \frac{1\cdot 2\cdot 3 \cdots m}{(1+n)(2+n)\cdots (m+n)}(m+1)^{n} = n!
\end{equation}
欧拉实际上在他的论文中描述了发现上述式子的思路，我们不在此赘述。上式成立其实
很容易证明。左边可以整理为
\begin{align*}
& \frac{1\cdot 2\cdot 3 \cdots m}{(1+n)(2+n)\cdots (m+n)}(m+1)^{n}  \\
= & \frac{1\cdot 2\cdot 3 \cdots n \cdot (n+1)(n+2) \cdots m}{(1+n)(2+n)\cdots m (m+1)(m+2)\cdots (m+n)}
     (m+1)^{n} \\
= & 1\cdot 2\cdot 3 \cdots n \cdot \frac{(n+1)(n+2) \cdots m}{(1+n)(2+n)\cdots m }
     \cdot \frac{(m+1)^{n}}{(m+1)(m+2)\cdots (m+n)} \\
= & n! \cdot \frac{(m+1)^{n}}{(m+1)(m+2)\cdots (m+n)} \\
= & n! \cdot \prod_{k=1}^{n} \frac{m+1}{m+k}  \\
\rightarrow & n! \qquad (m\rightarrow \infty)
\end{align*}
所以 \eqref{euler-series}、\eqref{euler-series2}式都成立。

由于\eqref{euler-series} 式对于$n$为分数的情形也适用，所以欧拉实际上也把$n!$
的计算推广到了分数的情形。欧拉给的无穷乘积相比丹尼尔的无穷乘积有什么更出色的地
方吗？实际上后人的验证指出，就收敛到$n!$的速度而言，丹尼尔的无穷乘积比欧拉的要
快得多，然而欧拉的无穷乘积公式却是能够下金蛋的鸡。 欧拉极其擅长数学的观察与归纳
，他开始尝试从一些简单的例子做分数阶乘的计算，看看是否有规律可循。当
$n=\frac{1}{2}$ 的时候，代入 \eqref{euler-series} 式，可以得到
\begin{align*}
\Bigl(\frac{1}{2}\Bigr)! 
= & \sqrt{\frac{2}{1}} \cdot \frac{2}{3} \cdot \sqrt{\frac{3}{2}} \cdot \frac{4}{5} 
    \cdot \sqrt{\frac{4}{3}} \cdot \frac{6}{7} \cdot \sqrt{\frac{5}{4}} \cdot \frac{8}{9} 
    \cdot \cdots  \\
= & \sqrt{\frac{4}{2}} \cdot \frac{2}{3} \cdot \sqrt{\frac{6}{4}} \cdot \frac{4}{5}
    \cdot \sqrt{\frac{8}{6}} \cdot \frac{6}{7} \cdot \sqrt{\frac{10}{8}} \cdot \frac{8}{9} 
    \cdot \cdots  \\
= & \sqrt{\frac{4}{3} \cdot \frac{2}{3}} \cdot \sqrt{\frac{6}{5} \cdot \frac{4}{5}}
    \cdot \sqrt{\frac{8}{7} \cdot \frac{6}{7}} \cdot \sqrt{\frac{10}{9} \cdot \frac{8}{9}} 
    \cdot \cdots  \\
= & \sqrt{\frac{2}{3} \cdot \frac{4}{3} \cdot \frac{4}{5} \cdot \frac{6}{5}
    \cdot \frac{6}{7} \cdot \frac{8}{7} \cdot \frac{8}{9} \cdot \frac{10}{9} \cdot \cdots } . 
\end{align*}
对照一下根号内的式子和沃利斯公式\eqref{wallis-formula}，几乎是一模一样！只是最
前面差了一个因子2。 欧拉自然非常熟悉沃利斯的工作，基于沃利斯公式，欧拉迅速得到了
一个令他惊讶的结果
$$ \Bigl(\frac{1}{2}\Bigr)! = \frac{\sqrt{\pi}}{2} .$$

\begin{figure}[htbp]
\centering
\includegraphics[width=0.8\textwidth]{gamma/euler-swiss-banknote.jpg}
\caption{瑞士法郎上的欧拉}
\end{figure}

真是殊途同归！对于阶乘在分数$\frac{1}{2}$上的推广，欧拉得到了和当年斯特灵相同的结
果。 欧拉继续尝试计算更多分数的阶乘。 欧拉给的无穷乘积也满足阶乘的递归式$T(z)
= z T(z-1)$, 结合递归式欧拉计算了其它几个分数，包括 $\frac{5}{2}, \frac{1}{4},
\frac{3}{4}, \frac{1}{8}, \frac{3}{8} $ 的阶乘。在丹尼尔的鼓励之下，欧拉把自己
的公式以及一些分数阶乘的计算结果写信告知了哥德巴赫，这封信开启了欧拉和哥德
巴赫之间一生的通信交流。两人在接下来的 35 年里连续通信达到196封，这些信函成为了
数学家研究欧拉的重要资料。也正是哥德巴赫激发了欧拉对数论的兴趣，著名的哥德巴赫
猜想的首次现身就是在哥德巴赫写给欧拉的一封信中。

欧拉的这封信把分数阶乘的问题，又扎实地向前推进了一步。 犹如一场春雨，随风潜入夜
，润物细无声，伽玛函数的种子在土里发芽了，它积蓄着力量，等待着最后的灌溉和破土
而出。

欧拉是具有超凡数学直觉的一流数学家，他注意到 $ (\frac{1}{2})!$ 中居然有 $\pi$,
这引起他的深思。
对于擅长数学分析的数学家而言，有 $\pi$ 的地方必然有和圆相关的积分。由于沃利斯的
时代微积分理论还没有被系统地发明出来，沃利斯使用插值的方式做推导计算，但是沃利斯
公式的推导过程本质上就是在处理积分。因此欧拉猜测 $n!$ 应该可以表达为某种积分形
式。如果说沃利斯当年发现他的公式只是无心插柳，那后继者欧拉对于阶乘向分数推广的
研究将开垦出一片绿洲。 

受沃利斯工作的启发，欧拉开始考虑如下一般形式的积分
$$ J(e,n) = \int_0^1 x^e(1-x)^ndx ,$$
此处 $n$ 为正整数，$e$ 为正实数。利用分部积分法，很容易证明
$$ J(e,n) = \frac{n}{e+1}J(e+1,n-1) .$$
重复使用上述迭代公式，最终可以得到
$$ J(e,n) = \frac{1\cdot2\cdots n}{(e+1)(e+2)\cdots(e+n+1)} .$$
于是欧拉得到如下一个重要的式子
\begin{equation}
n! = (e+1)(e+2)\cdots(e+n+1)\int_0^1 x^e(1-x)^ndx .
\end{equation}
在这个公式里欧拉实际上已经成功地把$n!$ 表示成了积分的形式。然而
$(e+1)(e+2)\cdots(e+n+1)$ 这个表达式限制了 $n$ 只能为整数，无法推广到分数的情形
。能否简化这个积分表达式，让$e$ 从积分式子中消失呢？要让一个量从一个数学等式中
消失，数学家惯用的手法之一就是让这个量取一个极端的值，譬如无穷。在通往无穷的路
途中，宇宙的奥秘往往被数学家窥视。欧拉开始通过数学变换技巧让$e$ 趋向于无穷取值。
取
$e=\frac{f}{g}$, 稍微整理一下可以得到
$$ \frac{n!}{(f+g)(f+2g)\cdots(f+ng)} = \frac{f+(n+1)g}{g^{n+1}} \int_0^1 x^\frac{f}{g}(1-x)^n dx , $$
然后令 $f \rightarrow 1, g \rightarrow 0$，显然上式左边趋于$n!$, 右边会发生什么
情况呢？为了简化计算，令 $x=t^h, h=\frac{g}{f+g}$， 整理之后上式可以变换为
\begin{align}
\frac{n!}{(f+g)(f+2g)\cdots(f+ng)}
& = \frac{f+(n+1)g}{g^{n+1}} \int_0^1 h(1-t^h)^n dt  \notag \\
& = \frac{f+(n+1)g}{(f+g)^{n+1}} \int_0^1 \Bigl(\frac{1-t^h}{h}\Bigr)^n dt .
\label{factorial-integral}
\end{align}
当$f \rightarrow 1, g \rightarrow 0$ 时显然有$h \rightarrow 0$，利用罗必塔法则
，我们可以得到微积分中一个熟知的式子
$$ \lim_{h \rightarrow 0} \frac{1-t^h}{h} = -\log t .$$
由此，对 \eqref{factorial-integral} 式两边取极限，奇迹出现了：
\begin{equation}
\label{factorial-gamma-1}
n! = \int_0^1 (-\log t)^ndt .
\end{equation}
原来积分式中的$e$消失了，欧拉成功地把$n!$表达为了一个非常简洁的积分形式！！！
对上式再做一个变换 $t=e^{-\lambda}$,就得到我们常见的伽玛函数形式
\begin{equation}
\label{factorial-gamma-2}
 n! = \int_0^{\infty} \lambda^ne^{-\lambda}d\lambda .
\end{equation}
把\eqref{factorial-gamma-1}和\eqref{factorial-gamma-2} 式从正整数$n$ 延拓到任意实
数$x$，我们就得到伽玛函数的一般形式
$$ \Gamma(x+1) = \int_0^1 (-\log t)^{x}dt =  \int_0^{\infty} t^{x}e^{-t}dt .$$
1730年 欧拉把他推广得到的$n!$的积分形式再次写信告知了哥德巴赫，欧拉的这封信犹如
春雷惊起千年蛰，伽玛函数破土而出，年仅23岁的欧拉完美地解决了困扰哥德巴赫多年的
分数阶乘的问题。而伽玛函数这颗嫩芽生命力旺盛，在接下来的几百年中，将接受众多的
数学大师们的灌溉培育，开始茁壮成长。 

\begin{figure}[htbp]
\centering
\includegraphics[width=0.7\textwidth]{lda/gamma-func.png}
\caption{$\Gamma(x)$ 在正半轴的图像}
\end{figure}

回味欣赏一下欧拉推导伽玛函数的过程，我们会觉得整个过程清晰、流畅、自然，这就是
欧拉做数学研究的风格。 欧拉和高斯都是历史上具有超凡直觉的一流数学家，但是两位数
学大师做数学研究的风格却迥然不同。高斯在数学上严谨细致，呈现研究结果小心谨慎。
他的格言是 “当一幢建筑物完成时,应该把脚手架拆除干净”。所以发表研究结果的时候
常把思考的痕迹抹去，只留下那些漂亮、令人惊叹、却难以追根溯源的结果，这招致了一
些数学家对高斯的批评。
而欧拉的风格不同，他经常通过经验直觉做非常大胆的猜测，然后小心细致地求证，欧拉
的文章中留下了许多做数学猜想的痕迹，中间的证明的过程有时不够严谨，但是最
终的结论却极少出错。欧拉总是把最基本的东西解释得尽量清楚，讲明引导他得出结论的
思路。他的数学技巧超凡脱俗，时常把看似不相关的数学式子糅合在一起变换出惊人而富
有创造性的结论, 读者要理解他的思路与结论却并不困难。
拉普拉斯曾说过：“读读欧拉 ,他是我们所有人的老师。”
而高斯的评价是：“学习欧拉的著作，乃是认识数学的最好工具。”
数学家波利亚在他的名著《数学与猜想》中列举了许多欧拉做数学研究的例子，对欧拉做
数学归纳和猜想的方式推崇备至。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.4\textwidth]{gamma/euler_cup.jpg}
\caption{欧拉的数学发现}
\end{figure}

欧拉被称为分析学的化身，在分析学中，无出其右者。欧拉的老师约翰·贝努利在给欧拉
的信中这样评价欧拉的工作：“ 我介绍高等分析的时候，它还是个孩子，而你正在将它带
大成人。” 希尔伯特说“分析学是无穷的交响曲”，欧拉显然是无穷分析中最出色的作曲
家。欧拉二百多年前写的教科书《无穷分析引论》至今还在不断地印刷，最近也刚刚出版
了中文翻译版本。布尔巴基学派的灵魂人物韦伊( Andr\'{e} Weil, 1906-1998) 1979 年
在 Rochester大学的一次讲演中说：“今天的学生从欧拉的《无穷分析引论》中所能得到
的益处，是现代任何一本数学教科书都比不上的。”

许多人把数学比作音乐，把欧拉称作数学界的贝多芬。因为贝多芬在两耳失聪之后继续
谱写了大量著名的交响曲，而欧拉在60岁左右双目失明之后仍然以口述形式完成了几本书
和 400 多篇论文，在数学上变得更加多产。 数学界从1911年开始出版《欧拉全集》，耗
费了一个世纪的时间，已经出版了70余卷， 25000多页， 而这项庞大的出版任务还仍处于
未完成状态。

\section{$ \Gamma(n) = (n-1)!$ 还是  $ \Gamma(n) = n! $ ? }

伽玛函数找到了，我们来看看第二个问题，为何伽玛函数被定义为满足
$\Gamma(n)=(n-1)!$？ 如果我们对参数稍微做一点移位修正，把伽玛函数定义中的 $t^{x-1}$
替换为 $t^x$ 
$$ \Gamma(x) = \int_0^{\infty} t^{x}e^{-t}dt , $$
使得伽玛函数满足$\Gamma(n)=n!$，这样不是更加自然吗? 这个问题也是理科背景的学生
学习高等数学的时候的FAQ(Frequently Asked Question) ，然而答案却一直有些争议。  

伽玛函数被发现以后，在早期的数学文献中的形态并不统一。实际上，欧拉最早引入的伽玛
函数定义还真是如上所示，满足 $\Gamma(n)=n!$。而高斯在研究伽玛函数的时候， 是用
符号$\Pi$来定义： 
$$ \Pi(x)=\int_{0}^\infty t^x e^{-t}\,dt ,$$ 
不过这个定义并没有流传开来。伽玛函数在数学界的形态的最终统一要归功于勒让德。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.3\textwidth]{gamma/Legendre.jpg}
\caption{勒让德肖像水彩画}
\end{figure}

欧拉在伽玛函数的推导中实际上引入了两类积分形式
$$ \int_0^1 t^{x}(1-t)^{y}dt, \quad  \quad \int_0^{\infty} t^{x}e^{-t}dt .$$
现在分别称为欧拉第一类积分和欧拉第二类积分。勒让德追随欧拉的脚步，发表了多篇论
文对欧拉积分进行了深入的研究和推广。有意思的是，在勒让德的研究中，对积分中的参
数做了 $-1$的移位修改，定义为
$$ B(x, y) = \int_0^1 t^{x-1}(1-t)^{y-1}dt, \quad \quad  \Gamma(x) = \int_0^{\infty} t^{x-1}e^{-t}dt .$$
$B(x,y)$ 现在称为贝塔积分或者贝塔函数。而基于上式的伽玛函数定义导
致了 $ \Gamma(n) = (n-1)!$ , 这同时也是首次引入$\Gamma$符号给伽玛函数冠名。勒让德
给出的伽玛函数定义被法国数学家广泛采纳并在世界范围推广，最终使得这个定义在现
代数学中成为了既成事实。

什么原因驱使勒让德选择$\Gamma(n) = (n-1)!$ 的定义呢？ 这成为一个谜，没有明确的
解释。 数学史研究者们对欧拉的研究表明，在$1730\sim1768$ 年之间，欧拉自己在研究一
类积分的时候，对积分参数做了$-1$的移位修改，从而明确地引入了贝塔积分，而这个修
改显然被勒让德注意到了。 什么原因使欧拉和勒让德引入$-1$ 移位修改呢？ 后来的数学
家们给出了一些猜测，一个可能的原因是这两位数学大师注意到，按照现代伽玛函数的定义，那
么
\begin{equation}
\label{beta-gamma-decompose}
 B(x,y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)} ,
\end{equation}
$B(x,y)$ 具有非常漂亮的对称形式。如果选取高斯给出的 $\Pi(n)=n!$ 的定义，
则有
$$ B(x,y) = \frac{\Pi(x)\Pi(y)}{\Pi(x+y+1)} ,$$
这个形式显然不如\eqref{beta-gamma-decompose} 式具有简洁的对称美，数学家总是非常
在乎数学公式的美感的。

还有一个类似的解释是从抽象代数的角度提出的，考虑伽玛分布的概率密度函数
$$ f_\alpha(x)=\begin{cases} \dfrac{x^{\alpha-1} e^{-x}}{\Gamma(\alpha)} 
& , x>0 \\[12pt] 0 & , x<0 \end{cases} $$
形成的集合 $\{f_\alpha : \alpha > 0\}$, 那么该集合在卷积运算 $*$ 之下构成一
个抽象代数中的半环，即满足
$$ f_\alpha * f_\beta = f_{\alpha+\beta} .$$
采用$\Pi(x)$ 的定义则无法得到类似的结果。 


对于伽玛函数定义中$-1$参数移位的合理性，现代数学家还提供了一个额外的解释，当然
这个解释和欧拉、勒让德的选择并无关系。这个更具启发性的解释也是从抽象代数角度描
述的。 对伽玛函数
$$ \Gamma(x) = \int_0^{\infty} e^{-t}t^{x-1}dt $$
做一个线性变换 $h: t \rightarrow ct$，可以得到如下函数
\begin{equation}
\label{generalized-gamma}
\frac{\Gamma(x)}{c^x}  = \int_0^{\infty} e^{-ct} t^x \frac{dt}{t} . 
\end{equation}
此处， $dt/t = d \log t$ 可以被看成是乘法群 $(0, \infty)$ 上的一个不变测度，在尺
度伸缩变换下满足不变性：
$$ \frac{d(ct)}{ct} = \frac{dt}{t} .$$
而积分式中的 $e^{-ct}$ 对应于群上的一个加法特征(additive character) $f$， 满足 
$$f(t+s) =f(t) \cdot f(s) ,$$ 
$t^x$ 对应于群上的一个乘法特征(multiplicative character) $g$， 满足
$$g(t \cdot s) = g(t) \cdot g(s) .$$
由于积分表示的是求和， 所以\eqref{generalized-gamma} 式 被看成是乘法群 $(0,
\infty)$ 上加法特征和乘法特征混合乘积的累积求和。基于这个分解，只要在抽象代数的
有限域上定义了$f$ 和$g$ 这两个映射， \eqref{generalized-gamma} 式中在实数域上定
义的$\frac{\Gamma(x)}{c^x}$ 函数就可以被推广到有限域上进行定义，只是无限求和的
积分号$\int$ 需要被替换为有限求和符号$\Sigma$ 。 进一步，借用贝塔函数和伽玛函数
满足的关系式\eqref{beta-gamma-decompose}, $B(x,y)$ 也可以完全类似的在有限域中定
义， 这种推广也同样具有简洁的对称美。


\section{伽玛函数欣赏}

伽玛函数从它诞生开始就备受青睐，众多数学大师们对它追逐研究，包括高斯、勒让德、魏
尔斯特拉斯、柳维尔等等。数学家发现这个函数拥有大量奇特的性质，为解决众多重要的
数学问题搭建了桥梁。 

由于阶乘存在一个斯特林公式，所以伽玛函数作为阶乘的推广，首先也满足如下的斯特林公式
$$ \Gamma(x) \approx \sqrt{2\pi}e^{-x}x^{x-\frac{1}{2}} .$$

数是我们在数学中接触的最普通的概念，人类对数系的认识的道路上却布满了荆棘与坎
坷。从整数、分数、有理数到无理数、实数、虚数、复数，这些数的概念的理解却是累积
了千年的沉淀，背后隐藏了多少代数学家的汗水。数学家对数的思考常常拥有惊世骇俗
的思维：每一个实数都可以计算阶乘, {\bf 那复数可以计算阶乘吗?} 数学家给我们提供
了神奇的答案：我们不仅可以计算 $ (-7.5)!, (\frac{1}{2})!,\pi !$ ，我们甚至可以
计算 $(\frac{1}{2} + \frac{1}{3}i)!$。阶乘的概念居然可以延拓到复数，这真是太
不可思议！ 其实理由很简单： 因为积分的概念可以被延拓到整个复平面上。实际上，十
八世纪的数学家们着手开垦复变函数论这片沃土之后，基于积分定义的伽玛函数被延拓到
整个复平面上自然就不足为奇了。


\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{lda/gamma-complex.png}
\caption{复平面上的伽玛函数}
\end{figure}

除了阶乘，伽玛函数貌似离我们很遥远，日常生活中看不到它的影子。其实伽玛函数栖身
于众多我们熟悉的事物之中。譬如，我们最为常见的圆、球就和伽玛函数紧密相关。我们
知道二维球(圆)的面积为 $\pi r^2$，三维球的体积为 $\frac{4}{3} \pi r^3$，那半径
为$r$ 的$n$维球的体积是多少呢？ 这个体积是如下多重积分
$$ \displaystyle V_n(r) = \idotsint\limits_{ \tiny \{(x_1, \cdots, x_n) | \sum x_i^2 < r^2 \} }  1 \quad dx_1dx_2 \cdots dx_n  .$$
这个计算需要一点想象力，实际上可以很容易地证明 \footnote{在 Wikipedia 上可以找到一个很有启发性的证明方法。}
$$ V_n(r) = \frac{\pi^{\frac{n}{2}} r^n}{\Gamma(\frac{n}{2} + 1)} .$$ 
瞧，$n$维球体积公式完全依赖于伽玛函数，我们日常熟悉的圆的面积、球的体积公
式不过是它的特例而已。 

\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{gamma/n-dim-ball.jpg}
\caption{$n$ 维球的体积}
\end{figure}


伽玛函数还有很多妙用，它能扩展一些重要的数学概念，譬如导数。我们学习过一阶、
二阶等整数阶导数，而数学家却追问一个令人脑洞大开的问题：{\bf 我们能定义分数阶的
导数吗？} 这个问题太令人难以捉摸了，恐怕读者们完全无法想象什么叫分数阶的导数。 
然而这个问题却历史悠久，早年莱布尼茨研究微积分的时候就提出来过这个问题，只是没
有获得实质性进展。欧拉给出了伽玛函数之后，也开始研究分数阶导数的问题，并给出了
如下非常具有启发性的想法。我们观察一下函数$f(x) = x^n$ 的各阶导数
\begin{table}[H]
\centering
\caption{$x^n$ 的各阶导数}
\begin{tabular*}{0.8\textwidth}{@{\extracolsep{\fill}}cl}
\\
$f'(x)$ & $nx^{n-1}$ \\
$f''(x)$ & $n(n-1)x^{n-2}$ \\
$f^{(3)}(x)$ & $n(n-1)(n-2)x^{n-3}$ \\
$\cdots$ &  \\
$f^{(k)}(x)$ & $n(n-1)(n-2)\cdots(n-k+1)x^{n-k} = \frac{n!}{(n-k)!} x^{n-k}$. 
\end{tabular*}
\end{table}
上式最后一行，我们发现$k$阶导数是用阶乘来表达，于是可以用伽玛函数重写为
$$ f(x)^{(k)} = \frac{\Gamma{(n+1)}}{\Gamma{(n-k+1)}} x^{n-k} .$$
伽玛函数大显身手的机会来了！基于上式，取$n=1, k=\frac{1}{2}$ 我
们就可以计算 $f(x)=x$ 的 $\frac{1}{2}$阶导数为
$$ x^{(\frac{1}{2})} = \frac{\Gamma{(1+1)}}{\Gamma{(1-1/2+1)}} x^{1-1/2} 
= \frac{2\sqrt{x}}{\sqrt{\pi}} .$$
显然以上计算过程对于$n, k$ 为任意实数的情形都适用，于是我们就很自然地把$x^n$的
导数的定义从整数阶延拓到分数阶。

那一般的可导函数$f(x)$ 可以定义分数阶导数吗？ 一般的函数 $f(x)$ 可以通过泰
勒级数展开表达为幂级数，所以欧拉很容易想到借用 $x^n$ 的分数阶导数来定
义出任意可导函数的分数阶导数。这种简单的方式确实能够处理不少函数，遗憾的是在某
些函数上由于不能满足收敛性要求,因而定义是失效的。虽然欧拉没能够在函数的分数阶导
数的问题上进一步深入，但是他的这个思路给后来的数学家打开了一道门，这门通向数学
分析中的一个神奇的世界：分数微积分 (Fractional Calculus) 。一般可导函数的分数阶
导数在这个世界中都是有意义的，{\bf 甚至积分运算也可以有分数阶}，因为积分运算是
导数的逆运算。这听起来是不是很有趣？而伽玛函数正是开启这道奇妙之门的魔法钥匙。 


数学家擅长刨根问底，从各个角度考察他们发现和创造的数学实体。 整数阶乘被欧拉推
广到伽玛函数之后，紧接着被问的一个问题是：{\bf 伽玛函数是整数阶乘唯一的推广函数
吗？} 答案却是否定的，丹尼尔·贝努利最早的无穷乘积推广就已经说明了存在多种推广延拓的
方式。譬如$\Gamma(x) \cos (2x\pi)$ 这个函数显然也满足把阶乘延拓到实数集。 
那伽玛函数凭什么鹤立鸡群、集万千数学家的宠爱于一身呢？从伽玛函数的图像我们可
以看到它是一个凸函数。凸函数是数学家们宠爱的对象，一个函数是凸函数往往意味着
它有众多良好的性质。那伽玛函数是唯一的满足凸性的阶乘函数吗？答案还是否定的。但
是数学家发现不仅 $\Gamma(x)$ 是一个凸函数， $\log\Gamma(x)$ 也是一个凸函数，这
可是难得一见的优良品质。实际上可以证明如下定理:
\begin{theorem}[Bohr-Mollerup] 如果 $f:(0,\infty)\rightarrow (0,\infty)$,且满足
\begin{enumerate}
\item $f(1) = 1$
\item $f(x+1) = xf(x)$
\item $\log f(x)$ 是凸函数
\end{enumerate}
那么 $f(x) = \Gamma(x)$。
\end{theorem}
一言以蔽之：伽玛函数拥有优良血统，它是唯一的在取对数后还满足凸性的阶乘推广函数。

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{lda/digamma-func.png}
\caption{$\log \Gamma(x)$ 是一个凸函数}
\end{figure}

伽玛函数像是一位神奇的魔术师，时常从黑色帽子中拉出活蹦乱跳的兔子，令人惊诧不已。
伽玛函数有不少等价的表示形式和神奇的结果。高斯给出的伽玛函数的形式是
$$ \Gamma(x) = \lim_{n\rightarrow\infty} \frac{n^x n!}{x(x+1)(x+2)\cdots(x+n)} .$$
欧拉证明了如下一个漂亮的反射公式
$$ \Gamma(x) \Gamma(1-x) = \frac{\pi}{\sin (\pi x)} .$$
看！伽玛函数和我们最为熟悉的三角函数发生了紧密的关联。
魏尔斯特拉斯把高斯的伽玛函数形式简单地做一下变换，就得到表达为无穷乘积的如下结果
$$ {\Gamma(x)} = \frac{1}{xe^{\gamma x}} \prod_{k=1}^\infty
\frac{e^{\frac{x}{k}}} {1+\frac{x}{k}} .$$
此处 $\gamma \approx 0.5772156649\cdots$ 为欧拉常数。这个结果在复平面上也成立。
由伽玛函数的这个分解形式的启发，魏尔斯特拉斯发现复平面上任意整函数$f(z)$ 都可
以分解为无穷乘积形式。之前在介绍沃利斯公式的时候，提到了欧拉发现的
$\sin x$ 的无穷乘积展开式 \eqref{euler-sinx} ，我们也说过这个展开式的证明并不算
简单。实际上，基于魏尔斯特拉斯这个伽玛函数的无穷乘积形式和欧拉的反射公式，
整理简化一下 $\Gamma(1+x)\Gamma(1-x)$， 就可以得到对 \eqref{euler-sinx} 式的
一个简洁的证明。

数论号称数学上的皇冠。伽玛函数看起来和数论八竿子打不着，却在这顶皇冠之中熠熠生
辉。 伽玛函数和欧拉常数 $\gamma$ 有密切关系，可以发现
$$ \gamma = -\frac{d\Gamma(x)}{dx}|_{x=1} =
\lim_{n\rightarrow \infty}(1+\frac{1}{2} + \frac{1}{3}+\cdots+\frac{1}{n} - \log n) . $$
欧拉常数$\gamma$ 是一个神奇的常数，它到底是一个有理数还是一个
无理数？数学家至今都耿耿于怀。进一步还可以发现伽玛函数和黎曼Zeta函数
$$ \zeta(s) = 1+\frac{1}{2^s} + \frac{1}{3^s} + \cdots $$
有着密切联系。黎曼发现了如下式子
$$ \zeta(x) \Gamma(x) = \int_0^\infty \frac{u^{x-1}}{e^u - 1} du ,$$
$$ \zeta(x) = \zeta(1-x) \Gamma(1-x) 2^s \pi^{s-1} \sin\left(\frac{\pi x}{2}\right)  .$$
这可了不得！ $\zeta$ 函数在解析数论中有着举足轻重的地位，它涉及了数学中极其著
名的素数分布定理和黎曼猜想，而以上两个式子在分析黎曼猜想过程中有重要作用。数学
家蒙哥马利有一句名言：“假如你是一个魔鬼，引诱数学家用自己的灵魂来换取一个定理
的证明。多数数学家会想要换取的会是什么定理呢，我想会是黎曼猜想。” 而希尔伯特曾
说过，如果他在沉睡1000年后醒来, 他将问的第一个问题便是：黎曼猜想得到证明了吗？

前面提到了 $\log\Gamma(x)$ 是一个凸函数。对这个函数求导得到的函数
$$ \Psi(x) = \frac{d\log\Gamma(x)}{dx}  $$
被称为 Digamma 函数。可以证明
$$\Psi(x) = -\gamma + (x-1) - \frac{(x-1)(x-2)}{2\cdot 2!} 
+ \frac{(x-1)(x-2)(x-3)}{3\cdot 3!} \cdots $$
这也是一个很重要的函数，具有如下漂亮的性质
$$ \Psi(x+1) = \Psi(x) + \frac{1}{x} .$$
基于这个递归性质，把上式在正整数上作递归展开就得到调和级数 $1+\frac{1}{2} +
\frac{1}{3} + \frac{1}{4} + \cdots $，所以$\Psi(x)$ 在调和级数研究中扮演重要角
色。 进一步，函数$\Psi(x)$和欧拉常数$\gamma$ 以及 $\zeta$ 函数都有密切关系。令
$$ \Psi_n(x) = \frac{d^{n+1}\log\Gamma(x)}{dx^{n+1}} ,$$
可以证明
$$\Psi_1(x) = \frac{d^{2}\log\Gamma(x)}{dx^{2}}
= \frac{1}{x^2} + \frac{1}{(x+1)^2} + \frac{1}{(x+2)^2} + \cdots .$$
对于几个具体的数值，有如下漂亮的结果
$$\Psi(1) = -\gamma, \quad \quad \Psi(2) = 1-\gamma ,$$
$$\Psi_1(1) = \zeta(2) = 1 + \frac{1}{2^2} + \frac{1}{3^2} + \frac{1}{4^2} +  \cdots 
= \frac{\pi^2}{6} .$$


\section{随机数学中的伽玛函数}

伽玛函数在概率统计中频繁现身，众多的统计分布，包括常见的统计学三大分布($t$ 分布
，$\chi^2$ 分布，$F$ 分布)、贝塔分布、狄利克雷分布的密度公式中都有伽玛函数的
身影。当然发生最直接联系的概率分布是直接由伽玛函数变换得到的伽玛分布。对伽玛函
数的定义做一个变形，可以得到如下式子
\begin{equation}
\label{gamma-distribution}
\int_0^{\infty} \frac{x^{\alpha-1}e^{-x}}{\Gamma(\alpha)}dx = 1 .
\end{equation}
取上式积分号中的函数作为概率密度，就得到一个形式最简单的伽玛分布密度函数
$$Gamma(x|\alpha) = \frac{x^{\alpha-1}e^{-x}}{\Gamma(\alpha)} .$$
如果在\eqref{gamma-distribution} 式中做变换 $x=\beta t$, 就得到伽玛分布密度
函数更一般的形式
$$Gamma(t|\alpha, \beta) = \frac{\beta^\alpha t^{\alpha-1}e^{-\beta t}}{\Gamma(\alpha)} .$$

\begin{figure}[htbp]
\centering
\includegraphics[width=0.6\textwidth]{lda/gamma-distribution.png}
\caption{\label{gamma-distr-graph}$ Gamma(\alpha,\beta)$分布图像}
\end{figure}

伽玛分布在概率统计领域也是一个万人迷，众多概率分布都和它有密切关系。 我们熟悉
的指数分布$Exp(\lambda)$和$\nu$个自由度的卡方分布 $\chi^2_{(\nu)}$ 其实都是
伽玛分布的特例，密度函数分别对应于 $Gamma(1, \lambda)$ 和
$Gamma(\frac{\nu}{2}, \frac{1}{2})$ 。 观察图 \ref{gamma-distr-graph} 可以发现
，伽玛分布在不同的参数配置下可以呈现众多的形状，因此具有强大的拟合数据的能力。
伽玛分布同时是一个很强大的先验分布，在贝叶斯统计分析中被广泛地用作其它分布的先
验。如果把统计分布中的共轭关系类比为人类生活中的情侣关系的话，那指数分布、泊松
分布、正态分布、对数正态分布都可以看作是伽玛分布的情人。

接下来的内容中我们主要关注$\beta = 1$的简单形式的伽玛分布。伽玛分布首先和泊松分
布发生密切的联系。容易发现伽玛分布和泊松分布在数学形式上具有高度的一致性。参数
为$\lambda$的泊松分布，概率分布写为
$$Poisson(X=k|\lambda) = \frac{\lambda^k e^{-\lambda}}{k!} , $$
在伽玛分布的密度函数中取 $\alpha = k+1$ 得到
$$ Gamma(\lambda|\alpha=k+1) 
= \frac{\lambda^ke^{-\lambda}}{\Gamma(k+1)}= \frac{\lambda^k e^{-\lambda}}{k!} . $$
这二者一模一样！这两个分布的数学形式具有高度的一致性。只是泊松分布是离散的，伽玛分布
是连续的。这种数学上的一致性难道是偶然的吗？ 事实上，从泊松分布出发，利用一
个简单的概率物理模型可以对伽玛分布的密度函数给出清晰的物理解释。

泊松分布可以用于描述一段时间内事件发生次数的统计性质，譬如接到的电话的次数。假
设我们关心的不是一段有限的时间，而是 $(0, \infty)$ 整个时间轴上接到电话的统计性
质，应该如何来描述呢？我们可以假设接到的电话满足如下性质
\begin{enumerate}
\item 概率在时间轴是独立均匀分布的，即每个等长的时间区间上是否接到电话是独立的
，并且概率分布一样；每一个长度为h的充分小的时间片上接到一个电话的概率正比于时间
片的长度；
\item 每一个充分小时间片上最多只能接到一个电话；
\item 平均而言，假设每个长度为1的单位时间片上接到电话个数是1。
\end{enumerate}
如果我们考察 $[0, \lambda]$ 这个时间区间，那么平均而言，这个长度为 $\lambda$ 的
时间片上应该接到 $\lambda$ 个电话，把这个时间区间分成 $n$ 个独立的小片，那么每
个时间片上接到一个电话的概率恰好是 $p = \lambda/n$。当$n$ 足够大的时候，每个时
间片上只能接到一个电话或者没有接到电话，恰好对应于成功概率为$p$ 的一个贝努利
实验。于是$n$ 个时间片对应于$n$ 个独立的贝努利实验，所以 $[0, \lambda]$这个时间
区间上接到的电话总数$X$ 应该符合二项分布
$$p(X=k) = \binom{n}{k} p^k(1-p)^{n-k} .$$
由于 $np= \lambda$, 当 $n$ 趋向于无穷的时候，电话个数$X$将满足参数为
$\lambda$ 的泊松分布
$$p(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} .$$

熟悉随机过程理论的读者马上会发现以上模型实际上是参数为1 的泊松过程。 我们关心的
问题是：什么时候会接到第${k+1}$ 个电话？或者说{\bf 接到第$k+1$ 个电话的时间点
$Y_{k+1}$ 会是什么概率分布？} 形式化的描述就是如何计算如下概率
$$ P(\lambda < Y_{k+1} \le \lambda +  d\lambda) = ? .$$
上式的含义是第$k+1$ 个电话落在长度为 $d\lambda$ 的区间 $(\lambda, \lambda +
d\lambda] $ 内，这个概率事件可以分解为两个独立事件
\begin{enumerate}
\item 区间 $(\lambda, \lambda +  d\lambda] $ 内接到一个电话，这个概率是 $d \lambda .$ （由于这个时间片足够小，按照题目要求，也只能接到一个电话.)
\item 区间 $[0, \lambda]$ 内接到了前$k$ 个电话，这个概率是 
$$ p(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} .$$
\end{enumerate}
于是所求的概率是以上两个事件概率相乘，即
$$ P(\lambda < Y_{k+1} \le \lambda +  d\lambda) = p(X=k) \cdot d \lambda .$$
由于第$k+1$ 个电话必然出现在时间轴上某处，所以把时间轴所有无穷小区间上的概率累
加起来，正好对应于必然事件的概率1，所以有
$$ \int_0^\infty  p(X=k) \cdot d \lambda  = 1 .$$
把$P(X=k)$ 代入上式即可得到 
$$ \int_0^\infty \frac{\lambda^k e^{-\lambda}}{k!}  d \lambda  = 1 ,$$
$$ k! = \int_0^\infty \lambda^k e^{-\lambda} d \lambda .$$
上述两式正好就对应于伽玛分布和伽玛函数对阶乘的推广。所以，{\bf  接到第$k+1$ 个
电话的时间点 $Y_{k+1}$ 恰好符合伽玛分布}。 综上， 我们其实是从泊松分布出发，完
全基于概率物理模型，推导出了伽马分布和伽玛函数，而推导的过程给伽玛分布的密度函
数提供了很好的物理解释。

如果我们把$e^\lambda$的泰勒展开式和伽玛函数对照写成如下形式：
\begin{align}
e^\lambda & =  \sum_{k=0}^{\infty} {\lambda^k \over k!} , \\
k! & =  \int_0^{\infty} {\lambda^k \over e^\lambda}\ d\lambda ,
\end{align}
我们发现这两个式子形式上具有对偶关系。由于 $\sum$ 和$\int$ 都表示求和， 几乎可
以认为从第一个式子只是把 $e^\lambda$ 和 $k!$ 交换一下就得到了第二个式子。 这两
个式子之间有更多的内在联系吗？事实上如下一个奇妙的等式成立：
\begin{equation}
\label{gamma-e-taylor}
\frac{1}{k!} \int_0^\lambda \frac{\lambda^k}{e^\lambda} d\lambda 
+ \frac{1}{e^\lambda} \sum_{n=0}^k \frac{\lambda^n}{n!} = 1 .
\end{equation}

用上面描述的泊松过程的物理模型，可以很容易的证明这个等式。我们把数轴分成
$(0, \lambda]$ 和 $(\lambda, \infty)$ 这两个区间，考察第$k+1$ 个电话接到的时间
$Y_{k+1}$ 分别落在这两个区间的概率，当然有
$$ P(Y_{k+1} \le \lambda) + P(Y_{k+1} > \lambda)  = 1 .$$
按照上述的物理模型，显然第$k+1$ 个电话的时间落入$(0, \lambda]$ 的概率为
$$ P(Y_{k+1} \le \lambda) = \int_0^\lambda \frac{\lambda^k e^{-\lambda}}{k!}  d \lambda .$$
如果第$k+1$ 个电话的时间点落入 $(\lambda, \infty)$，这个事件等价地可以理解为 $(0,
\lambda]$ 上的电话个数不能超过 $k$ 个，由于$(0, \lambda]$ 这个有限时间区间上的
电话次数符合参数为$\lambda$ 的泊松分布， 所以这个概率为
$$  P(Y_{k+1} > \lambda) = Poisson(X \le k|\lambda) = \sum_{n=0}^k \frac{\lambda^n e^{-\lambda} }{n!} .$$
所以我们得到
\begin{equation}
\label{poisson-gamma-dual}
\int_0^\lambda \frac{\lambda^k e^{-\lambda}}{k!}d\lambda 
+ \sum_{n=0}^k \frac{\lambda^n e^{-\lambda}}{n!} = 1 .
\end{equation}
这个式子俗称{\bf 泊松-伽玛对偶}，将它简单整理一下就是 \eqref{gamma-e-taylor} 式。

由于泊松分布可以看做是二项分布的极限分布，我们也可以从二项分布的角度对伽玛
分布进行解释。由于 
$$ e^{-\lambda} = \lim_{n\rightarrow \infty} (1- \frac{\lambda}{n}) ^n ,$$
所以伽玛分布的概率密度可以重写为
\begin{align*}
\frac{\lambda^k e^{-\lambda}}{k!} 
& = \lim_{n\rightarrow \infty} \frac{\lambda^k (1-\frac{\lambda}{n}) ^n}{k!}  \\
& = \lim_{n\rightarrow \infty} \frac{ n! n^k (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n}{k! \cdot n!} \\
& = \lim_{n\rightarrow \infty} \frac{(n+k)!}{k!\cdot n!} (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n  \\
& = \lim_{n\rightarrow \infty} \binom{n+k}{k} (\frac{\lambda}{n})^k (1-\frac{\lambda}{n}) ^n  .
\end{align*}
显然上式具有明确的二项分布的物理含义。进一步，二项分布和贝塔分布之间也存在完全
类似\eqref{poisson-gamma-dual} 的一个等式：
\begin{equation}
\label{binomial-beta-dual}
\frac{n!}{k!(n-k-1)!} \int_0^p t^k(1-t)^{n-k-1} dt + \sum_{v=0}^k \binom{n}{v} p^v(1-p)^{n-v} = 1 .
\end{equation}
事实上我们知道$n\rightarrow\infty$时上式中二项分布的极限是泊松分布，而贝塔分布的
极限是伽玛分布，那么就很容易理解 \eqref{poisson-gamma-dual} 其实可以看做是
\eqref{binomial-beta-dual} 的极限形式。 

\section{结语}


作家海明威有一句名言：“冰山运动之雄伟壮观，是因为它只有八分之一在水面上。”阶
乘这个基于整数的数学概念，俨然是一座冰山宫殿！整数的一角漂浮于水面之上，朴实无
华，迷惑了众人的眼睛。满怀好奇心的数学探险家们却眼光犀利深邃， 洞察了那水下的奥
秘。 在深入细致地分析探索中, 探险家们来到了深藏于冰山深处的一个深邃而庞大的洞穴
入口 --- 那是神奇的伽玛函数的宫殿之门。 数学探险家们争先恐后进入洞穴一窥究竟，
却不识庐山真面目，几代探险家们的努力下终于发现这是一座雄伟壮观的冰山宫殿，宫殿的
基石由实数域、复数域、甚至是有限域搭建而成, 屋顶由整数铺设，宫殿深藏于水中，微
微露出一角。 殿中有众多迷人的现代数学宫室， 琳琅满目地陈列着伽玛函数的神奇技艺
，令人赏心悦目、流连忘返。 

\begin{figure}[t]
\centering
\includegraphics[height=0.5\textwidth, width=0.8\textwidth]{gamma/iceberg.png}
\caption{伽玛函数冰山}
\end{figure}

许多人认为数学的概念是静态的：数学概念产生于历史上某一个时刻，某一位数学大家之
手，之后就几乎一成不变了。对于大多数非数学专业的人而言，这种感觉很自然，毕竟普
通读者所接触的几何、代数、微积分这些数学知识早就已经体系成熟，存在了几百甚至上
千年。 然而数学的发展其实是先有探索的阶段，然后才会沉淀为逻辑与体系，只是我们的
数学课本历来偏重后者而忽视前者。如果我们对数学知识的探索过程有所了解的话，会发
现这些探索也犹如冰山掩藏在水面之下的部分，甚至比露出的尖角还更具魅力。 

台湾的数学教授蔡聪明先生在数学的科普传播方面写过大量的文章，他在《数学的发现趣
谈》一书中对于数学的创造、发现与发展有一段精彩的论述：“如果你不知道一个定理（
或公式）是怎样发现的，那么你对它并没有真正的了解，因为真正的了解必须从逻辑因果
掌握到创造的心理因果。一个定理的诞生，基本上跟一粒种子在适当的土壤、风雨、阳光
、气候 ... 之下，发芽成一颗树，再开花结果，并没有两样。”本文尝试尽可能的呈现伽
玛函数这颗数学之树的生长历程，可以说伽玛函数的种子最早是沃利斯播下的，欧拉给予
了最好的施肥、灌溉使得种子发芽，而后来众多数学家的努力使得这颗嫩芽茁壮成长，
最终几乎成长为一颗参天大树。

伽玛函数这颗大树在现代数学中如此繁茂，笔者知识浅薄仅能描绘它很有限的一部分。这
个函数在数学上魅力独特，不仅能够被一个理科本科生很好的理解，它本身又足够的深刻
，具有很多漂亮的数学性质，历史上曾吸引了众多一流的数学家对它进行探索研究。美国数
学家 Philip J.Davis 在1959年的《美国数学月刊》上发表了一篇很有名的介绍伽玛函数
的文章，文中对伽玛函数一些特性发现的历史进行了详细的描述，这篇文章获得了
Chauvenet Prize (美国数学会颁发的数学科普奖)。 他在文章的末尾做了一句总结, 我把
它理解为那是对神奇的伽玛函数由衷的赞美和认同：

\begin{quotation}
\noindent
\emph{Each generation has found something of interest to say about the gamma
function.  Perhaps the next generation will also.}
\kaishu{(每一代人都发现了一些伽玛函数的有趣性质，也许下一代人也会有所发现。)}
\end{quotation}


\section{推荐阅读}

如果希望了解更多阶乘研究以及伽玛函数相关的历史，推荐阅读如下文献：
\begin{itemize}
\item 蔡聰明, 瓦里斯尋$\pi$ 的發現理路,科学月刊, 27(4) 1996
\item 蔡聰明, 瓦里斯公式及其相關的結果,科学月刊, 27(5), 1996 
\item 蔡聰明, 談 Stirling 公式, 数学传播 , 17(2), 1993
\item Philip J. Davis, Leonhard Euler's Integral: A Historical Profile of the Gamma Function, The American Mathematical Monthly, vol. 66, pp. 849-869, 1959 
\item Jacques Dutka, The Early History of the Factorial Function, Archive for History of Exact Sciences, 43 (3), pp. 225-249, 1991
\item Detlef Gronnau, Why is the gamma function so as it is?, Teaching Mathematics and Computer Science, 2003
\item Emil Artin, The Gamma function(English Traslation),  Holt, Rinehart and Winston, Inc., 1964
\item George E. Andrews et al., Special Functions, Cambridge University Press, 2001
\item Ian Tweddle, James Stirling's Methodus Differentialis: An Annotated Translation of Stirling's Text, Springer, 2003
\end{itemize}
% bibliogrphaphy


% 考虑用到最后的总结中
% 法国伟大的数学家庞加莱（Poincare, 1854-1912）说过：我们用逻辑来证明，但是用直觉
% 来发现。逻辑…是不孕的，除非它跟直觉受精。

